# 1. load the data

post16 <-read.csv(file.choose(), header = TRUE)

library(dplyr)

# Define the list of establishment types to remove
exclude_types <- c(
  "Community special school",
  "City technology college",
  "Academy special sponsor led",
  "Non-maintained special school",
  "Free schools special",
  "University technical college",
  "Studio schools",
  "Pupil referral unit",
  "Free schools alternative provision"
)

post16_clean <- post16 %>%
  # 1. Remove rows with empty string in Eligible.for.Free.School.Meals
  filter(Eligible.for.Free.School.Meals != "") %>%
  
  # 2. Remove rows with blank Type.of.Establishment
  filter(Type.of.Establishment != "") %>%
  
  # 3. Remove rows where Type.of.Establishment matches excluded values
  filter(!Type.of.Establishment %in% exclude_types) %>%
  
  # 4. Convert Eligible.for.Free.School.Meals to numeric
  mutate(Eligible.for.Free.School.Meals = as.numeric(Eligible.for.Free.School.Meals)) %>%
  
  # 5. Create quintile column (1 = highest, 5 = lowest)
  mutate(quintile = ntile(desc(Eligible.for.Free.School.Meals), 5))


write.csv(post16_clean,
          "C:\\Users\\mfbx4jwn\\OneDrive - The University of Manchester\\M&E Officer\\MPM\\MPM 2025\\Post16_FSM.csv",
          row.names = FALSE)



